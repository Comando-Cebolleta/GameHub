{% extends 'base.html.twig' %}

{% block title %}Mis Builds - GameHub{% endblock %}

{% block stylesheets %}
    <link rel="stylesheet" href="{{ asset('css/styleLogin.css') }}">
    <link rel="stylesheet" href="{{ asset('css/styleMisBuilds.css') }}">
{% endblock %}

{% block body %}
    {% include 'partials/header.html.twig' with {'iconColor': 'GOLD'} %}

    <main>
        <div class="builds-wrapper">
            <h1 class="title-gold">Mis Builds</h1>

            {% if builds is empty %}
                <div class="empty-state" style="text-align: center; padding: 40px;">
                    <p>No tienes builds creados aún.</p>
                </div>
            {% else %}
                <div class="builds-grid">
                    {% for build in builds %}
                        <article class="card-build">
                            <div class="card-img-container">
                                <a href="{{ path('app_build_view', {'id': build.id}) }}">
                                    <img src="{{ asset('assets/personajes/' ~ build.personajePlantilla.imagen) }}"
                                         alt="{{ build.personajePlantilla.nombre }}"
                                         class="card-img">
                                </a>
                            </div>

                            <div class="card-body">
                                <a href="{{ path('app_build_view', {'id': build.id}) }}" style="text-decoration: none;">
                                    <h3>{{ build.nombre }}</h3>
                                </a>
                                <p>{{ build.personajePlantilla.nombre }}</p>

                                <div class="build-actions">
                                    {# REDIRECCIÓN SEGÚN JUEGO #}
                                    {% if build.personajePlantilla.juego == 'genshin' %}
                                        {# Enlace para GENSHIN #}
                                        <a href="{{ path('app_build_genshin_edit', {'id': build.id}) }}" class="btn-gold">Editar</a>
                                    {% else %}
                                        {# Enlace para HONKAI #}
                                        <a href="{{ path('app_build_hsr_edit', {'id': build.id}) }}" class="btn-gold">Editar</a>
                                    {% endif %}

                                    {# BOTÓN BORRAR #}
                                    <form method="post" action="{{ path('app_build_delete', {'id': build.id}) }}" onsubmit="return confirm('¿Borrar esta build?');">
                                        <input type="hidden" name="_token" value="{{ csrf_token('delete' ~ build.id) }}">
                                        <button type="submit" class="btn-gold">Borrar</button>
                                    </form>
                                </div>
                            </div>
                        </article>
                    {% endfor %}
                </div>
            {% endif %}

            <div class="navigation-footer">
                <a href="{{ path('app_profile') }}" class="back-btn">
                    <span>&larr;</span> Volver a Mi Perfil
                </a>
            </div>
        </div>
    </main>

    <footer>
        Game Hub &copy; 2025-2026
    </footer>
{% endblock %}