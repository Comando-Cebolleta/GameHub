{% extends 'base.html.twig' %}

{% block title %}Mi Perfil - GameHub{% endblock %}

{% block stylesheets %}
    <link rel="stylesheet" href="{{ asset('css/styleProfile.css') }}">
    <link rel="stylesheet" href="{{ asset('css/styleLogin.css') }}">
{% endblock %}

{% block body %}

    {# INCLUSIÓN DEL HEADER MODULAR #}
    {% include 'partials/header.html.twig' %}

    <main style="position: relative;"> {# Añadido relative aquí para que el mensaje flote respecto a este contenedor #}

        {# --- MENSAJE FLOTANTE (No empuja el diseño) --- #}
        {% for message in app.flashes('success') %}
            <div style="
                position: absolute;
                top: 10px;
                left: 50%;
                transform: translateX(-50%);
                z-index: 999;
                background: #1f1b2e;
                color: #c2b46c;
                border: 2px solid #c2b46c;
                padding: 10px 25px;
                border-radius: 12px;
                box-shadow: 0 5px 20px rgba(0,0,0,0.6);
                font-weight: bold;
                white-space: nowrap;
                animation: fadeOut 4s forwards;
            ">
                {{ message }}
            </div>
        {% endfor %}

        <div class="profile-container">
            {# Mensajes de éxito/error al actualizar ajustes #}
            {% for message in app.flashes('success') %}
                <div class="alert alert-success" style="color: #c2b46c; text-align: center; margin-bottom: 20px;">
                    {{ message }}
                </div>
            {% endfor %}


            {# --- Banner Superior --- #}
            <div class="profile-banner">
                <a href="{{ path('app_settings') }}" class="settings-icon" title="Configuración del Perfil">
                    <img src="{{ asset('assets/img/settingsIconGOLD.webp') }}" alt="Ajustes">
                </a>
            </div>

            {# --- Avatar del Usuario --- #}
            <div class="profile-avatar">
                {% if app.user.fotoPerfil %}
                    <img src="{{ asset('uploads/avatars/' ~ app.user.fotoPerfil) }}" alt="Avatar de {{ app.user.userName }}">
                {% else %}
                    <img src="{{ asset('assets/img/default_avatar.webp') }}" alt="Avatar por defecto">
                {% endif %}
            </div>

            {# --- Nombre de Usuario --- #}
            <h2 class="profile-username">
                {{ app.user.userName|default(app.user.userIdentifier) }}
            </h2>

            {# --- Tarjetas de Contenido --- #}
            <div class="profile-cards-container">
                <a href="{{ path('app_profile_builds') }}" class="profile-card">Mis builds</a>
                <a href="{{ path('app_profile_posts') }}" class="profile-card">Mis publicaciones</a>
            </div>
        </div>
    </main>

    <footer>
        Game Hub &copy; 2025-2026
    </footer>

    {# Pequeño estilo para que el mensaje desaparezca suavemente #}
    <style>
        @keyframes fadeOut {
            0% { opacity: 1; }
            80% { opacity: 1; }
            100% { opacity: 0; visibility: hidden; }
        }
    </style>
{% endblock %}