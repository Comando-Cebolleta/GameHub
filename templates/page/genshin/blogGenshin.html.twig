{% extends 'base.html.twig' %}

{% block title %}GameHub Blog Genshin{% endblock %}

{% block stylesheets %}
    <link rel="stylesheet" href="{{ asset('css/styleBlogGENSHIN.css') }}">

    <style>
        /* --- AJUSTES DINÁMICOS DEL HEADER PARA GENSHIN --- */
        header .login-container {
            display: flex;
            align-items: center;
            gap: 15px;
            background: transparent !important;
            border: none !important;
            box-shadow: none !important;
            padding: 0 !important;
            width: auto !important;
        }

        .user-info {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            text-align: right;
        }

        .welcome-text {
            color: #c2b46c; /* Dorado para Genshin */
            font-weight: bold;
            font-size: 0.9rem;
        }

        .logout-link {
            color: #ffffff;
            font-size: 0.75rem;
            text-decoration: underline !important;
            opacity: 0.7;
        }

        .logout-link:hover {
            opacity: 1;
            color: #ffadad;
        }

        /* Estilo para el enlace del título */
        .post-link {
            text-decoration: none;
            color: inherit;
            transition: opacity 0.2s;
        }
        .post-link:hover {
            opacity: 0.8;
        }
    </style>
{% endblock %}

{% block body %}

    {# Invocamos el header modular con GOLD #}
    {% include 'partials/header.html.twig' with {'iconColor': 'GOLD'} %}

    <main>
        <div class="container blog-wrapper">
            <div class="top-actions">
                <a href="{{ path('genshin_nuevo_post', {'juego': 'genshin'}) }}" title="Crear Post">
                    <img src="{{ asset('assets/img/postIconGOLD.webp') }}" alt="Crear Post" class="action-icon">
                </a>

                <a href="{{ path('app_build_genshin_create') }}" title="Crear Build">
                    <img src="{{ asset('assets/img/buildIconGOLD.webp') }}" alt="Crear Build" class="action-icon">
                </a>
            </div>

            {% if posts is empty %}
                <div style="text-align: center; padding: 50px; opacity: 0.7;">
                    <p>Todavía no hay publicaciones sobre Genshin Impact. ¡Sé el primero en escribir una!</p>
                </div>
            {% else %}
                {% for post in posts %}
                    <article class="post-card">
                        <div class="post-content">
                            <a href="{{ path('genshin_post', {'id': post.id}) }}" class="post-link">
                                <h2>{{ post.titulo }}</h2>
                            </a>
                            <p>
                                {# striptags quita el HTML de CKEditor y slice corta el texto para el resumen #}
                                {{ post.cuerpo|striptags|slice(0, 250) ~ '...' }}
                            </p>
                        </div>

                        <div class="post-icons-area">
                            <span class="icon-label">Autor: {{ post.user.username }}</span>
                            <span class="icon-label" style="font-size: 0.75rem; opacity: 0.6; margin-top: 5px;">
                                {{ post.fechaPublicacion|date('d/m/Y') }}
                            </span>

                            {# Si en el futuro quieres añadir iconos de personajes, irían aquí #}
                        </div>
                    </article>

                    {# Añadimos la línea divisoria si no es el último post de la lista #}
                    {% if not loop.last %}
                        <hr class="divider">
                    {% endif %}
                {% endfor %}
            {% endif %}

        </div>
    </main>

    <footer>
        Game Hub &copy; 2025-2026
    </footer>

{% endblock %}