{% extends 'base.html.twig' %}

{% block title %}GameHub Blog Honkai: Star Rail{% endblock %}

{% block stylesheets %}
    <link rel="stylesheet" href="{{ asset('css/styleBlogHONKAI.css') }}">

    <style>
        header .login-container {
            display: flex;
            align-items: center;
            gap: 15px;
            background: transparent !important;
            border: none !important;
            box-shadow: none !important;
            padding: 0 !important;
        }
        .user-info {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            text-align: right;
        }
        .welcome-text {
            color: #c0c0c0; /* Plata para HSR */
            font-weight: bold;
            font-size: 0.9rem;
        }
        .logout-link {
            color: #ffffff;
            font-size: 0.75rem;
            text-decoration: underline !important;
            opacity: 0.7;
        }
        .logout-link:hover {
            opacity: 1;
            color: #ffadad;
        }
        .post-link {
            text-decoration: none;
            color: inherit;
            transition: opacity 0.2s;
        }
        .post-link:hover {
            opacity: 0.8;
        }
    </style>
{% endblock %}

{% block body %}

    {% include 'partials/header.html.twig' with {'iconColor': 'SILVER'} %}

    <main>
        <div class="container blog-wrapper">
            <div class="top-actions">
                <a href="{{ path('hsr_nuevo_post', {'juego': 'hsr'}) }}" title="Crear Post">
                    <img src="{{ asset('assets/img/postIconSILVER.webp') }}" alt="Crear Post" class="action-icon">
                </a>

                <a href="{{ path('app_build_hsr_create') }}" title="Crear Build">
                    <img src="{{ asset('assets/img/buildIconSILVER.webp') }}" alt="Crear Build" class="action-icon">
                </a>
            </div>

            {% if posts is empty %}
                <div style="text-align: center; padding: 50px; opacity: 0.7;">
                    <p>Todavía no hay publicaciones sobre Honkai: Star Rail. ¡Sé el primero en subir contenido!</p>
                </div>
            {% else %}
                {% for post in posts %}
                    <article class="post-card">
                        <div class="post-content">
                            <a href="{{ path('hsr_post', {'id': post.id}) }}" class="post-link">
                                <h2>{{ post.titulo }}</h2>
                            </a>
                            <p>
                                {# striptags limpia el HTML de CKEditor #}
                                {{ post.cuerpo|striptags|slice(0, 250) ~ '...' }}
                            </p>
                        </div>

                        <div class="post-icons-area">
                            <span class="icon-label"><a href="{{ path('app_profile', {'id': post.user.id}) }}">Autor: {{ post.user.username }}</a></span>
                            <span class="icon-label" style="font-size: 0.75rem; opacity: 0.6; margin-top: 5px;">
                                {{ post.fechaPublicacion|date('d/m/Y') }}
                            </span>
                        </div>
                    </article>

                    {% if not loop.last %}
                        <hr class="divider">
                    {% endif %}
                {% endfor %}
            {% endif %}

        </div>
    </main>

    <footer>
        Game Hub &copy; 2025-2026
    </footer>

{% endblock %}